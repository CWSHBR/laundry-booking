# Laundry Schedule Bot (Telegram + Kotlin + SQLite)

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø—Ä–∞—á–µ—á–Ω–æ–π.

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ñ–∞–º–∏–ª–∏—è + –Ω–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã) –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.
- –í—ã–±–æ—Ä –º–∞—à–∏–Ω—ã –∏ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —á–∞—Å–∞ —á–µ—Ä–µ–∑ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –Ω–∞ –æ–¥–∏–Ω –¥–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ –º–∞—à–∏–Ω—É –Ω–µ –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 1 —á–∞—Å.
- –ê–¥–º–∏–Ω-–º–µ–Ω—é: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—à–∏–Ω (–Ω–∞–∑–≤–∞–Ω–∏–µ, —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã), —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º (—É–¥–∞–ª–µ–Ω–∏–µ/–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ–Ω–µ–π), –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –ø–æ Telegram ID.
- –í–æ –≤—Å–µ—Ö –æ–∫–Ω–∞—Ö, –≥–¥–µ –±–æ—Ç –∂–¥—ë—Ç –≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—à–∏–Ω—ã, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–æ—Ç–∞ –∞–¥–º–∏–Ω–æ–º), –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ ¬´–û—Ç–º–µ–Ω–∞¬ª; –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç ¬´–û—Ç–º–µ–Ω–∞¬ª –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É /cancel.

–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
- Kotlin/JVM, Gradle, TelegramBots 6.8.0
- SQLite (—Ñ–∞–π–ª `laundry.db` –≤ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- SLF4J (simple)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: JDK 21 (Gradle wrapper –ø–æ–¥—Ç—è–Ω–µ—Ç –Ω—É–∂–Ω—ã–π toolchain), –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

1) –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç:

```zsh
./gradlew clean build -x test
```

2) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather (–∏–ª–∏ `TELEGRAM_BOT_TOKEN`)
- `PRIMARY_ADMIN_ID` ‚Äî Telegram user id –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–∏–ª–∏ `TELEGRAM_PRIMARY_ADMIN_ID`). –≠—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–º–µ–Ω—é.

–ü—Ä–∏–º–µ—Ä (zsh):

```zsh
export BOT_TOKEN="123456:ABC-DEF..."
export PRIMARY_ADMIN_ID="123456789"
```

3) –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏–∑ Gradle:

```zsh
./gradlew run
```

–õ–∏–±–æ —Å–æ–±—Ä–∞—Ç—å –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫:

```zsh
./gradlew installDist
./build/install/laundry-schedule/bin/laundry-schedule
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ë–î –±—É–¥–µ—Ç –≤ —Ñ–∞–π–ª–µ `laundry.db` –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

## –ó–∞–ø—É—Å–∫ –≤ Docker

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å Dockerfile —Å multi-stage —Å–±–æ—Ä–∫–æ–π. –ë–î —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –º–∞—É–Ω—Ç—É –∫–∞—Ç–∞–ª–æ–≥–∞ `/data`.

1) –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞:

```zsh
docker build -t laundry-schedule:latest .
```

2) –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –ë–î, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```zsh
mkdir -p /srv/laundry-data
```

3) –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ –≤–∞—à–∏):

```zsh
docker run -d \
  --name laundry-bot \
  --restart unless-stopped \
  -e BOT_TOKEN="123456:ABC-DEF..." \
  -e PRIMARY_ADMIN_ID="123456789" \
  -v /srv/laundry-data:/data \
  laundry-schedule:latest
```

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `jdbc:sqlite:laundry.db` –∏ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/data`, –ø–æ—ç—Ç–æ–º—É —Ñ–∞–π–ª –ë–î –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ –ø–æ –ø—É—Ç–∏ `/srv/laundry-data/laundry.db`.
- –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–∑–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ç–æ–º–µ.

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: docker-compose.yml

```yaml
services:
  laundry-bot:
    image: laundry-schedule:latest
    container_name: laundry-bot
    restart: unless-stopped
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - PRIMARY_ADMIN_ID=${PRIMARY_ADMIN_ID}
    volumes:
      - /srv/laundry-data:/data
```

–ó–∞–ø—É—Å–∫:

```zsh
docker compose up -d
```

## –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
  - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`. –ï—Å–ª–∏ –≤—ã –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã ‚Äî –±–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏: `–§–∞–º–∏–ª–∏—è –ù–æ–º–µ—Ä–ö–æ–º–Ω–∞—Ç—ã` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `–ò–≤–∞–Ω–æ–≤ 123`).
  - –í –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ ¬´–í—ã–±—Ä–∞—Ç—å –º–∞—à–∏–Ω—É¬ª, –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ —Å–≤–æ–±–æ–¥–Ω—ã–π —á–∞—Å (–ø–æ–º–µ—á–µ–Ω üü¢Ô∏è). –°–≤–æ—è –∞–∫—Ç–∏–≤–Ω–∞—è –±—Ä–æ–Ω—å –ø–æ–º–µ—á–µ–Ω–∞ ‚úÖ, –∑–∞–Ω—è—Ç—ã–µ —á—É–∂–∏–º–∏ ‚Äî ‚≠ïÔ∏è.
  - –í—ã –º–æ–∂–µ—Ç–µ —Å–Ω—è—Ç—å —Å–≤–æ—é –±—Ä–æ–Ω—å, –Ω–∞–∂–∞–≤ –Ω–∞ —Å–ª–æ—Ç —Å –æ—Ç–º–µ—Ç–∫–æ–π ‚úÖ.

- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
  - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/admin`.
  - ¬´–ú–∞—à–∏–Ω—ã¬ª ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–∞—à–∏–Ω—ã (–Ω–∞–∑–≤–∞–Ω–∏–µ, —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–∞—Ö 0‚Äì24, –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä 9‚Äì23 –∑–Ω–∞—á–∏—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –∏ 23:00) –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø–æ –¥–Ω—è–º. –í —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏:
    - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ ‚ùå, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å.
    - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ üü¢, —á—Ç–æ–±—ã –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Å–ª–æ—Ç –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –±–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏ Telegram ID.
  - ¬´–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã¬ª ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞ –ø–æ Telegram ID.
  - –í–æ –≤—Å–µ—Ö —à–∞–≥–∞—Ö —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –≤–≤–æ–¥–æ–º –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ ¬´–û—Ç–º–µ–Ω–∞¬ª, —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–≤–æ–¥ —Å–ª–æ–≤–∞ ¬´–û—Ç–º–µ–Ω–∞¬ª –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞ /cancel.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤

- `ru.bshaykhraziev.laundryschedule.bot` ‚Äî Telegram-–±–æ—Ç, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –∏ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä.
- `ru.bshaykhraziev.laundryschedule.db` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î –∏ –º–∏–≥—Ä–∞—Ü–∏–∏.
- `ru.bshaykhraziev.laundryschedule.model` ‚Äî –¥–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏.
- `ru.bshaykhraziev.laundryschedule.repo` ‚Äî –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º (users, admins, machines, bookings).
- `ru.bshaykhraziev.laundryschedule.service` ‚Äî —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.

## –ó–∞–º–µ—á–∞–Ω–∏—è
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
- –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –¥–∏–∞–ª–æ–≥–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—à–∏–Ω/–∞–¥–º–∏–Ω–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ in-memory —Å–æ—Å—Ç–æ—è–Ω–∏—è; –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —à–∞–≥–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è.

## –¢—Ä–∞–±–ª—à—É—Ç–∏–Ω–≥

- –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ: "Env BOT_TOKEN ... –Ω–µ –∑–∞–¥–∞–Ω" ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è `BOT_TOKEN` –∏ `PRIMARY_ADMIN_ID`.
- –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –∏ —É –ø—Ä–æ—Ü–µ—Å—Å–∞ –µ—Å—Ç—å –≤—ã—Ö–æ–¥ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç. –¢–∞–∫–∂–µ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω –≤—Ç–æ—Ä–æ–π –∫–æ–ø–∏–µ–π.
- SQLite-—Ñ–∞–π–ª –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∑–∞–ø–∏—Å—å –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ç–æ—Ä—É—é –∫–æ–ø–∏—é –±–æ—Ç–∞ –∏–ª–∏ –∑–∞–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ `laundry.db`.
